WARNING:tensorflow:From /usr/lusers/akaptano/.conda/envs/tensorflowenv/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
Using TensorFlow 2 backend.

Warning: 10000 points required, but 10100 points sampled.
Compiling model...
Building feed-forward neural network...
'build' took 0.062979 s

2021-05-30 13:09:42.153845: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
'compile' took 1.485312 s

2021-05-30 13:09:43.625944: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2399845000 Hz
Initializing variables...
Training model...

Step      Train loss                        Test loss                         Test metric   
0         [5.50e+03, 8.85e-05, 7.94e-03]    [2.50e+03, 0.00e+00, 0.00e+00]    [9.73e-01]    
1000      [9.78e-05, 4.59e-08, 7.94e-03]    [4.70e-05, 0.00e+00, 0.00e+00]    [1.00e+00]    
2000      [8.54e-05, 4.08e-08, 7.94e-03]    [4.09e-05, 0.00e+00, 0.00e+00]    [1.00e+00]    
3000      [6.80e-05, 2.83e-08, 7.94e-03]    [3.26e-05, 0.00e+00, 0.00e+00]    [1.00e+00]    
4000      [4.76e-05, 1.76e-08, 7.94e-03]    [2.28e-05, 0.00e+00, 0.00e+00]    [1.00e+00]    
5000      [3.91e-01, 3.41e-08, 7.94e-03]    [1.77e-01, 0.00e+00, 0.00e+00]    [1.00e+00]    

Best model at step 4000:
  train loss: 7.99e-03
  test loss: 2.28e-05
  test metric: [1.00e+00]

'train' took 634.002820 s

Compiling model...
'compile' took 0.789066 s

Training model...

Step      Train loss                        Test loss                         Test metric   
5000      [3.91e-01, 3.41e-08, 7.94e-03]    [1.77e-01, 0.00e+00, 0.00e+00]    [1.00e+00]    
5020      [5.81e-05, 1.10e-08, 7.94e-03]    [2.74e-05, 0.00e+00, 0.00e+00]    [1.00e+00]    

Best model at step 4000:
  train loss: 7.99e-03
  test loss: 2.28e-05
  test metric: [1.00e+00]

'train' took 4.177818 s

/usr/lusers/akaptano/.conda/envs/tensorflowenv/lib/python3.8/site-packages/tensorflow/python/keras/legacy_tf_layers/core.py:171: UserWarning: `tf.layers.dense` is deprecated and will be removed in a future version. Please use `tf.keras.layers.Dense` instead.
  warnings.warn('`tf.layers.dense` is deprecated and '
/usr/lusers/akaptano/.conda/envs/tensorflowenv/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer_v1.py:1692: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  warnings.warn('`layer.apply` is deprecated and '
Saving loss history to /gscratch/psicenter/akaptano/Psi-Tet-v2/deepxde/examples/loss.dat ...
Saving training data to /gscratch/psicenter/akaptano/Psi-Tet-v2/deepxde/examples/train.dat ...
Saving test data to /gscratch/psicenter/akaptano/Psi-Tet-v2/deepxde/examples/test.dat ...
(100, 100)
(10000, 2) (100, 100)
Traceback (most recent call last):
  File "mhd_equil.py", line 149, in <module>
    main()
  File "mhd_equil.py", line 139, in main
    GS = model.predict(X, operator=pde)
NameError: name 'pde' is not defined
